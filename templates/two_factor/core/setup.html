{% extends 'admin_base.html' %}
{% load static %}
{% load widget_tweaks %}
{% load i18n two_factor %}
{% load i18n %}
{% block content %}
    <main>
        <div class="tab-pane fade  show active" id="v-pills-2fa" role="tabpanel"
             aria-labelledby="v-pills-settings-tab">
            <div class="tab-content-head">
                <h3 class="set_up_title text-center">2nd Factor Authentication</h3>
            </div>
            <div class="tab-content-body">
                <h1 class="get_app_content">
                    {% block title %}{% trans "Enable Two-Factor Authentication" %}{% endblock %}</h1>
                {% if wizard.steps.current == 'welcome' %}
                    <p class="get_app_content">{% blocktrans trimmed %}You are about to take your account security to
                        the next level. Follow the steps in this wizard to enable two-factor
                        authentication.{% endblocktrans %}</p>
                {% elif wizard.steps.current == 'method' %}
                    <p class="get_app_content">{% blocktrans trimmed %}Please select which authentication method you
                        would
                        like to use.{% endblocktrans %}</p>
                {% elif wizard.steps.current == 'generator' %}
                    <p class="get_app_content">{% blocktrans trimmed %}To start using a token generator, please use your
                        smartphone to scan the QR code below. For example, use Google
                        Authenticator. Then, enter the token generated by the app.
                    {% endblocktrans %}</p>
                    <p><img src="{{ QR_URL }}" alt="QR Code" height='150' width='150'/></p>
                {% elif wizard.steps.current == 'sms' %}
                    <p class="get_app_content">{% blocktrans trimmed %}Please enter the phone number you wish to receive
                        the
                        text messages on. This number will be validated in the next step.
                    {% endblocktrans %}</p>
                {% elif wizard.steps.current == 'call' %}
                    <p class="get_app_content">{% blocktrans trimmed %}Please enter the phone number you wish to be
                        called on.
                        This number will be validated in the next step. {% endblocktrans %}</p>
                {% elif wizard.steps.current == 'validation' %}
                    {% if challenge_succeeded %}
                        {% if device.method == 'call' %}
                            <p class="get_app_content">{% blocktrans trimmed %}We are calling your phone right now,
                                please enter the
                                digits you hear.{% endblocktrans %}</p>
                        {% elif device.method == 'sms' %}
                            <p class="get_app_content">{% blocktrans trimmed %}We sent you a text message, please enter
                                the tokens we
                                sent.{% endblocktrans %}</p>
                        {% endif %}
                    {% else %}
                        <p class="alert alert-warning" role="alert">{% blocktrans trimmed %}We've
                            encountered an issue with the selected authentication method. Please
                            go back and verify that you entered your information correctly, try
                            again, or use a different authentication method instead. If the issue
                            persists, contact the site administrator.{% endblocktrans %}</p>
                    {% endif %}
                {% elif wizard.steps.current == 'yubikey' %}
                    <p class="get_app_content">{% blocktrans trimmed %}To identify and verify your YubiKey, please
                        insert a
                        token in the field below. Your YubiKey will be linked to your
                        account.{% endblocktrans %}</p>
                {% endif %}

                <form action="" method="post">{% csrf_token %}
                    {% include "two_factor/_wizard_forms.html" %}

                    {# hidden submit button to enable [enter] key #}
                    <div style="margin-left: -9999px"><input type="submit" value=""/></div>

                    {% include "two_factor/_wizard_actions.html" %}
                </form>
            </div>
        </div>
    </main>
{% endblock %}